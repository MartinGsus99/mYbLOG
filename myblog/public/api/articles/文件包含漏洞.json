{"title":"文件包含漏洞","uid":"fbb97311aca413409ad49ad63dd42c9d","slug":"文件包含漏洞","date":"2021-07-22T03:21:00.000Z","updated":"2021-08-07T16:10:12.000Z","comments":true,"path":"api/articles/文件包含漏洞.json","keywords":"Love And Freedom","cover":"img/bg14.jpg","content":"<h2 id=\"一、Defs\"><a href=\"#一、Defs\" class=\"headerlink\" title=\"一、Defs\"></a>一、Defs</h2><p>​    可执行的函数被保存在一个单个文件中，使用时直接调用函数。无需再次编写；</p>\n<p>​    由于传入的文件没有经过检验<strong>，动态包含文件</strong>，导入了意料之外的文件导致文件泄露和恶意代码注入；</p>\n<h3 id=\"1-常用导入函数\"><a href=\"#1-常用导入函数\" class=\"headerlink\" title=\"1.常用导入函数\"></a>1.常用导入函数</h3><p>​    include,require,fopen,readfile等；</p>\n<h4 id=\"（1）include，-require的区别\"><a href=\"#（1）include，-require的区别\" class=\"headerlink\" title=\"（1）include， require的区别\"></a>（1）include， require的区别</h4><p>​    include包含文件报错会继续运行，但是require会中断脚本运行；</p>\n<h4 id=\"（2）include-once（）-require-once\"><a href=\"#（2）include-once（）-require-once\" class=\"headerlink\" title=\"（2）include_once（）,require_once\"></a>（2）include_once（）,require_once</h4><p>​    仅包含一次同一个文件，若包含两次就终止脚本；</p>\n<h4 id=\"（3）-fopen（），readfile（）\"><a href=\"#（3）-fopen（），readfile（）\" class=\"headerlink\" title=\"（3） fopen（），readfile（）\"></a>（3） fopen（），readfile（）</h4><p>readfile读取到缓存区，返回一个整数； fopen返回一个指针；</p>\n<h2 id=\"二、分类\"><a href=\"#二、分类\" class=\"headerlink\" title=\"二、分类\"></a>二、分类</h2><h3 id=\"1-本地文件漏洞（LFI）\"><a href=\"#1-本地文件漏洞（LFI）\" class=\"headerlink\" title=\"1.本地文件漏洞（LFI）\"></a>1.本地文件漏洞（LFI）</h3><p>可以包含本地服务器的文件（通过上传传输到服务器），获得权限</p>\n<p>（1）文件在同一文件夹下</p>\n<p>（2）不在同一目录需要使用相对或绝对目录；</p>\n<h4 id=\"2-方法：\"><a href=\"#2-方法：\" class=\"headerlink\" title=\"2.方法：\"></a>2.方法：</h4><p>%00(PHP5.3.4一下才能使用)；</p>\n<p>重复.././防止字符串替换</p>\n<h3 id=\"3-远程文件漏洞（RFI）\"><a href=\"#3-远程文件漏洞（RFI）\" class=\"headerlink\" title=\"3.远程文件漏洞（RFI）\"></a>3.远程文件漏洞（RFI）</h3><p>类似于代码注入，将一段在外地的代码执行；</p>\n<p>前提：</p>\n<p>（1）allow_url_fopen()    allow_url_include()</p>\n<p>（2）</p>\n<p>（3）</p>\n<p>1=<a href=\"http://127.0.0.1:82/test.txtz\">http://127.0.0.1:82/test.txtz</a></p>\n","text":"一、Defs​ 可执行的函数被保存在一个单个文件中，使用时直接调用函数。无需再次编写； ​ 由于传入的文件没有经过检验，动态包含文件，导入了意料之外的文件导致文件泄露和恶意代码注入； 1.常用导入函数​ include,require,fopen,readfile等； （1）in...","link":"","photos":[],"count_time":{"symbolsCount":569,"symbolsTime":"1 mins."},"categories":[{"name":"网络安全","slug":"网络安全","count":2,"path":"api/categories/网络安全.json"}],"tags":[{"name":"Web","slug":"Web","count":3,"path":"api/tags/Web.json"},{"name":"Security","slug":"Security","count":1,"path":"api/tags/Security.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81Defs\"><span class=\"toc-text\">一、Defs</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E5%B8%B8%E7%94%A8%E5%AF%BC%E5%85%A5%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">1.常用导入函数</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%EF%BC%881%EF%BC%89include%EF%BC%8C-require%E7%9A%84%E5%8C%BA%E5%88%AB\"><span class=\"toc-text\">（1）include， require的区别</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%EF%BC%882%EF%BC%89include-once%EF%BC%88%EF%BC%89-require-once\"><span class=\"toc-text\">（2）include_once（）,require_once</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%EF%BC%883%EF%BC%89-fopen%EF%BC%88%EF%BC%89%EF%BC%8Creadfile%EF%BC%88%EF%BC%89\"><span class=\"toc-text\">（3） fopen（），readfile（）</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81%E5%88%86%E7%B1%BB\"><span class=\"toc-text\">二、分类</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%BC%8F%E6%B4%9E%EF%BC%88LFI%EF%BC%89\"><span class=\"toc-text\">1.本地文件漏洞（LFI）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-%E6%96%B9%E6%B3%95%EF%BC%9A\"><span class=\"toc-text\">2.方法：</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E6%BC%8F%E6%B4%9E%EF%BC%88RFI%EF%BC%89\"><span class=\"toc-text\">3.远程文件漏洞（RFI）</span></a></li></ol></li></ol>","author":{"name":"Martin","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"Be Myself","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"特殊矩阵及广义表","uid":"aa3121f0eb296174fb5353bf6a5b23c1","slug":"特殊矩阵和广义表","date":"2021-08-08T12:56:45.000Z","updated":"2021-08-07T16:05:24.000Z","comments":true,"path":"api/articles/特殊矩阵和广义表.json","keywords":"Love And Freedom","cover":"img/bg4.jpeg","text":"#include &lt;stdio.h> #include &lt;stdlib.h> #include &lt;string.h> int main() &#123; //存贮数据的数组 int Myarray[10]=&#123;10,5,7,3,12,20,17,4,23...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"编程","slug":"编程","count":9,"path":"api/categories/编程.json"}],"tags":[{"name":"C语言","slug":"C语言","count":9,"path":"api/tags/C语言.json"}],"author":{"name":"Martin","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"Be Myself","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"SQL注入步骤","uid":"236d610796a3ca78ed573065000889bd","slug":"SQL注入","date":"2021-07-22T03:20:00.000Z","updated":"2021-07-22T05:45:06.000Z","comments":true,"path":"api/articles/SQL注入.json","keywords":"Love And Freedom","cover":"img/bg5.jpeg","text":"SQL注入漏洞1、找注入点（’ “ ) ))）select * from users where id =’1’#’ limit 0,1;http://d1e1c384.yunyansec.com/Less-1/?id=1&#39;# 2、判断是否存在注入select * fro...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"网络安全","slug":"网络安全","count":2,"path":"api/categories/网络安全.json"}],"tags":[{"name":"Web","slug":"Web","count":3,"path":"api/tags/Web.json"},{"name":"SQL","slug":"SQL","count":1,"path":"api/tags/SQL.json"}],"author":{"name":"Martin","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"Be Myself","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}