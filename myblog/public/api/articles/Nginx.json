{"title":"Nginx","uid":"af6a277a1f79cc7652a602f9f57ed64f","slug":"Nginx","date":"2023-07-06T00:51:45.000Z","updated":"2023-07-07T02:12:06.626Z","comments":true,"path":"api/articles/Nginx.json","keywords":"Love And Freedom","cover":"img/bg13.jpg","content":"<h1 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h1><h2 id=\"一、简介\"><a href=\"#一、简介\" class=\"headerlink\" title=\"一、简介\"></a>一、简介</h2><ul>\n<li>Web 服务器</li>\n<li>解决 C10K 问题</li>\n<li>最大 5w 个并发连接</li>\n</ul>\n<h2 id=\"二、基本使用\"><a href=\"#二、基本使用\" class=\"headerlink\" title=\"二、基本使用\"></a>二、基本使用</h2><h3 id=\"1-基础\"><a href=\"#1-基础\" class=\"headerlink\" title=\"1.基础\"></a>1.基础</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\">#启动</span>\nnginx\n\n<span class=\"token function\">ps</span> <span class=\"token parameter variable\">-ef</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> nginx\n\n<span class=\"token comment\">#查看端口占用</span>\n<span class=\"token function\">lsof</span> <span class=\"token parameter variable\">-i:80</span>\n\n<span class=\"token comment\">#优雅停止</span>\nnginx <span class=\"token parameter variable\">-s</span> quit\n<span class=\"token comment\">#立即停止</span>\nnginx <span class=\"token parameter variable\">-s</span> stop\n\n<span class=\"token comment\">#重载配置文件</span>\nreoad\n\n<span class=\"token comment\">#重新打开日志文件</span>\nreopen\n\n<span class=\"token comment\">#查看配置文件位置</span>\nnginx <span class=\"token parameter variable\">-t</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>master 进程：负责读取和验证配置文件，管理 woker 进程，一个</p>\n<p>worker 进程：负责处理实际请求，多个</p>\n<p><img src=\"https://s3.bmp.ovh/imgs/2023/07/06/0fd07985cc88f932.png\"></p>\n<h3 id=\"2-静态网站\"><a href=\"#2-静态网站\" class=\"headerlink\" title=\"2.静态网站\"></a>2.静态网站</h3><p>HEXO 搭建博客，略</p>\n<h3 id=\"3-配置文件\"><a href=\"#3-配置文件\" class=\"headerlink\" title=\"3.配置文件\"></a>3.配置文件</h3><pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\">#核心数，和cpu数目一致最好\nwork-processes <span class=\"token number\">10</span>\n\n#每个核心能够连接的网络连接\nevents<span class=\"token punctuation\">&#123;</span>\n    work_connections <span class=\"token number\">1024</span>;\n<span class=\"token punctuation\">&#125;</span>\n\nhttp<span class=\"token punctuation\">&#123;</span>\n    include mime.types   <span class=\"token comment\">//包含相应的文件处理方法</span>\n\n    server<span class=\"token punctuation\">&#123;</span>\n\n\t<span class=\"token punctuation\">&#125;</span>\n\n\tserver<span class=\"token punctuation\">&#123;</span>\n\n    <span class=\"token punctuation\">&#125;</span>\n\n\tinclude servers<span class=\"token comment\">/*   //保存单个server配置文件\n&#125;\n</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"4-反向代理和负载均衡\"><a href=\"#4-反向代理和负载均衡\" class=\"headerlink\" title=\"4.反向代理和负载均衡\"></a>4.反向代理和负载均衡</h3><ul>\n<li>正向代理：代理客户端</li>\n<li>反向代理：代理服务端</li>\n</ul>\n<p>多个服务器对一个域名，隐藏服务器真实 IP</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">upstream backend<span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token comment\">//需要代理的服务器</span>\n    ip_hash<span class=\"token punctuation\">;</span>     <span class=\"token comment\">//统一浏览器hash到一个服务器，以后一直都是访问这个服务器了</span>\n\tserver <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span><span class=\"token operator\">:</span><span class=\"token number\">8001</span> weight<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n\tserver <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span><span class=\"token operator\">:</span><span class=\"token number\">8002</span> weight<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\tserver <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span><span class=\"token operator\">:</span><span class=\"token number\">8003</span> weight<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\nserver<span class=\"token punctuation\">&#123;</span>\n    location <span class=\"token operator\">/</span>app<span class=\"token punctuation\">&#123;</span>\n        proxy_pass http<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>backend<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token comment\">//默认轮询访问三个服务器</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"5-Https\"><a href=\"#5-Https\" class=\"headerlink\" title=\"5.Https\"></a>5.Https</h3>","text":"Nginx一、简介 Web 服务器 解决 C10K 问题 最大 5w 个并发连接 二、基本使用1.基础#启动 nginx ps -ef | grep nginx #查看端口占用 lsof -i:80 #优雅停止 nginx -s quit #立即停止 nginx -s stop ...","link":"","photos":[],"count_time":{"symbolsCount":893,"symbolsTime":"1 mins."},"categories":[{"name":"Nginx","slug":"Nginx","count":1,"path":"api/categories/Nginx.json"}],"tags":[{"name":"Nginx","slug":"Nginx","count":1,"path":"api/tags/Nginx.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Nginx\"><span class=\"toc-text\">Nginx</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\">一、简介</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">二、基本使用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E5%9F%BA%E7%A1%80\"><span class=\"toc-text\">1.基础</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99\"><span class=\"toc-text\">2.静态网站</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">3.配置文件</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#4-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%92%8C%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1\"><span class=\"toc-text\">4.反向代理和负载均衡</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#5-Https\"><span class=\"toc-text\">5.Https</span></a></li></ol></li></ol></li></ol>","author":{"name":"Martin","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"Be Myself","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"防抖与节流","uid":"cd6a12c0c07e3b04d0fd2533bf4aa0fa","slug":"JS防抖和节流","date":"2023-07-06T05:51:45.000Z","updated":"2023-07-07T02:13:22.364Z","comments":true,"path":"api/articles/JS防抖和节流.json","keywords":"Love And Freedom","cover":"img/bg2.jpg","text":"防抖与节流一、防抖1.应用场景 窗口 resize，滚动条 scroll，输入框 input 持续发生，具有过程的事件 2.应用：利用闭包实现let inputEvent = document.querySelector('input') let content = docume...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[{"name":"JS","slug":"JS","count":2,"path":"api/categories/JS.json"}],"tags":[{"name":"JS","slug":"JS","count":5,"path":"api/tags/JS.json"},{"name":"JS技巧","slug":"JS技巧","count":1,"path":"api/tags/JS技巧.json"}],"author":{"name":"Martin","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"Be Myself","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"","uid":"f73a8e23e6f6f669cf99c7dba8fa0722","slug":"TS问题","date":"2023-07-04T08:41:38.972Z","updated":"2023-07-04T09:34:16.416Z","comments":true,"path":"api/articles/TS问题.json","keywords":"Love And Freedom","cover":null,"text":"TS问题1.如何在typescript中解决 error TS2451: Cannot redeclare block-scoped variable ‘name’ 原因：在默认状态下，typescript 将 DOM typings 作为全局的运行环境，所以当我们声明 name...","link":"","photos":[],"count_time":{"symbolsCount":618,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Martin","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"Be Myself","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}